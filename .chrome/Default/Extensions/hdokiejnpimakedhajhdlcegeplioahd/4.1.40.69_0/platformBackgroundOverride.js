(function(d){d.initialize=function(){chrome.runtime.onConnect.addListener(function(c){if(0===c.name.indexOf("requestPort")){var e=d.initializeRequestFramework({sendContentScript:function(b){c.postMessage(b)},windowID:c.sender&&c.sender.tab?c.sender.tab.windowId:null,tabURL:c.sender&&c.sender.tab?c.sender.tab.url:null,tabID:c.sender&&c.sender.tab?c.sender.tab.id:null,frameIdentity:c.sender&&c.sender.tab?c.sender.tab.id+"-"+c.sender.frameId:null});c.onMessage.addListener(e.requestHandler);c.onDisconnect.addListener(function(){e.disconnectHandler()})}})};
d.openPopoverDialog=function(c){d.openTabDialog.apply(d,arguments)};d.refreshGroupNames=function(){};d.closePopovers=function(){chrome.extension.getViews({type:"popup"}).forEach(function(c){c.close()})};d.getFavicon=function(){var c=null,d=function(b,a){var f=document.createElement("img");f.src=b;f.addEventListener("load",function(){var b;b="";try{var c=document.createElement("canvas");c.height=f.clientHeight;c.width=f.clientWidth;c.getContext("2d").drawImage(f,0,0);b=c.toDataURL()}catch(h){}document.body.removeChild(f);
a(b)});f.addEventListener("error",function(){a("");document.body.removeChild(f)});document.body.appendChild(f)};document.addEventListener("DOMContentLoaded",function(){d("chrome://favicon/",function(b){c=b})});return function(b){b.url&&b.callback&&d("chrome://favicon/"+b.url,function(a){b.callback(a===c?"":a)})}}();(function(){var c=function(b){var a=chrome.extension.getViews({type:"tab",windowId:b.windowID});if(1===a.length)return a[0];for(var c=0,d=a.length;c<d;++c){var e=a[c];if(e.tabID===b.tabID)return e}return null},
e=function(b,a){LPTabs.get({tabID:b.id,callback:function(d){if(a.inject){var f=0,e=[].concat(a.inject.files),h=function(){++f===e.length&&(d.extendTop({context:a.inject.context}),a.inject.allFrames&&d.extendFrames({context:a.inject.context}),a.loadHandler&&a.loadHandler(d))};e.forEach(function(c){chrome.tabs.executeScript(b.id,{file:c,allFrames:a.inject.allFrames},h)})}else a.loadHandler&&a.loadHandler(d);if(a.closeHandler){var g=c(d.tabDetails);g&&g.addEventListener("beforeunload",function(){a.closeHandler(g)})}}})};
d.getCurrentTab=function(b){chrome.tabs.query({active:!0,currentWindow:!0},function(a){1===a.length&&LPTabs.get({tabID:a[0].id,callback:b})})};d.openDialogWindow=function(b){var a=b.features||{};a.url=b.url;a.type=chrome.windows.CreateType.POPUP;chrome.windows.create(a,function(a){e(a.tabs[0],b)})};d.openTab=function(b){chrome.tabs.create({url:b.url,active:!b.inactive},function(a){e(a,b)})};d.openWindow=function(b){chrome.windows.create({url:b.url},function(a){e(a.tabs[0],b)})};d.openSame=function(b){chrome.tabs.update(null,
{url:b.url},function(a){e(a,b)})};d.navigateTab=function(b){chrome.tabs.update(b.tabId,{url:b.url,active:!0},function(a){e(a,b)})};d.activateTab=function(b){chrome.windows.update(b.windowID,{focused:!0});chrome.tabs.update(b.tabID,{active:!0})};d.closeTab=function(b){chrome.tabs.remove(b.tabID)};d.onTabUpdated=function(b){if("function"===typeof b){var a=function(a,c){"complete"===c.status&&LPTabs.get({tabID:c.tabId,callback:b})};chrome.tabs.onUpdated.addListener(a)}return function(){chrome.tabs.onUpdated.removeListener(a)}};
d.onTabActivated=function(b){if("function"===typeof b){var a=function(a){LPTabs.get({tabID:a.tabId,callback:b})};chrome.tabs.onActivated.addListener(a)}return function(){chrome.tabs.onActivated.removeListener(a)}};d.onTabClosed=function(b){if("function"===typeof b){var a=function(a){b(a)};chrome.tabs.onRemoved.addListener(a)}return function(){chrome.tabs.onRemoved.removeListener(a)}};d.onTransition=function(b){if("function"===typeof b){var a=function(a){b(a)};chrome.webNavigation.onCommitted.addListener(a)}return function(){chrome.webNavigation.onCommitted.removeListener(a)}}})()})(LPPlatform);
